<aura:component controller="emailController" implements="force:hasRecordId,flexipage:availableForAllPageTypes"
    access="global">

    <aura:attribute name="searchKey" type="String" />
    <aura:attribute name="searchResults" type="List" />
    <aura:attribute name="recipientIds" type="List" default="[]" />
    <aura:attribute name="recipientNames" type="List" default="[]" />
    <aura:attribute name="subject" type="String" />
    <aura:attribute name="body" type="String" />

    <div class="slds-card slds-p-around_medium">
        <h1 class="slds-text-heading_medium">âœ‰ Email</h1>
        <div class="slds-border_top "></div>
        <div class="slds-form-element">
            <label class="slds-form-element__label">To:</label>
            <div class="slds-form-element__control slds-grid slds-wrap ">
                <aura:iteration items="{!v.recipientNames}" var="name" indexVar="index">
                    <lightning:pill label="{!name}" name="{!index}" onremove="{!c.removeRecipient}"
                        class="slds-m-left_xx-small slds-m-right_xx-small slds-m-bottom_xx-small" />
                </aura:iteration>
                <div style="min-width: 200px;">
                    <lightning:input variant="label-hidden" placeholder="Type to search..." value="{!v.searchKey}"
                        onchange="{!c.handleKeyChange}" />
                </div>
            </div>
        </div>
        <aura:if isTrue="{!not(empty(v.searchResults))}">
            <ul class="slds-dropdown slds-dropdown_length-5 slds-dropdown_fluid">
                <aura:iteration items="{!v.searchResults}" var="item">
                    <li class="slds-dropdown__item" onclick="{!c.selectRecipient}" data-id="{!item.Id}"
                        data-name="{!item.Name}">
                        <a>
                            <span class="slds-truncate">{!item.Name}</span>
                        </a>
                    </li>
                </aura:iteration>
            </ul>
        </aura:if>
        <lightning:input name="Subject" required="true" value="{!v.subject}" label="Subject" />
        <lightning:inputRichText label="Body" value="{!v.body}" placeholder="Body area..." />

        <lightning:button class="slds-m-top_medium" label="Send" onclick="{!c.SendEmail}" />
    </div>
</aura:component>